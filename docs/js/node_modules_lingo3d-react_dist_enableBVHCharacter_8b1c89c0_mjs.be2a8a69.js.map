{"version":3,"file":"js/node_modules_lingo3d-react_dist_enableBVHCharacter_8b1c89c0_mjs.be2a8a69.js","mappings":"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","sources":["webpack://sourcedao-pc-dapp/./node_modules/lingo3d-react/dist/PhysicsUpdate.53e00069.mjs","webpack://sourcedao-pc-dapp/./node_modules/lingo3d-react/dist/bvhManagerMap.42e66e00.mjs","webpack://sourcedao-pc-dapp/./node_modules/lingo3d-react/dist/enableBVHCharacter.8b1c89c0.mjs","webpack://sourcedao-pc-dapp/./node_modules/lingo3d-react/dist/useBVHMap.904b6c6a.mjs"],"sourcesContent":["var h = Object.defineProperty;\nvar i = (s, t, e) => t in s ? h(s, t, { enumerable: !0, configurable: !0, writable: !0, value: e }) : s[t] = e;\nvar a = (s, t, e) => (i(s, typeof t != \"symbol\" ? t + \"\" : t, e), e);\nclass x {\n  constructor() {\n    a(this, \"x\", !1);\n    a(this, \"y\", !1);\n    a(this, \"z\", !1);\n  }\n  updateX() {\n    this.x = !0;\n  }\n  updateY() {\n    this.x = !0;\n  }\n  updateZ() {\n    this.x = !0;\n  }\n  updateXYZ() {\n    this.x = this.y = this.z = !0;\n  }\n  updateXZ() {\n    this.x = this.z = !0;\n  }\n  reset() {\n    this.x = this.y = this.z = !1;\n  }\n}\nexport {\n  x as P\n};\n","import { aM as t } from \"./index.e61493f3.mjs\";\nconst [a, s] = t(0), o = () => a(s() + 1), n = () => a(s() - 1), p = /* @__PURE__ */ new WeakMap();\nexport {\n  p as b,\n  n as d,\n  s as g,\n  o as i\n};\n","import { aD as A, bh as V, bi as G, bj as H, b6 as w, bk as z, aE as L, bl as P, bm as T, bn as F, bo as B, aI as C, bp as I, aJ as R, w as N, aK as q, aL as D, b8 as J, bq as K, br as Q, a as X } from \"./index.e61493f3.mjs\";\nimport { g as U } from \"./useBVHMap.904b6c6a.mjs\";\nimport { g as _, b as Y } from \"./bvhManagerMap.42e66e00.mjs\";\nimport { P as j } from \"./PhysicsUpdate.53e00069.mjs\";\nimport \"react\";\nimport \"react-dom\";\nconst y = /* @__PURE__ */ new Set(), Z = () => /* @__PURE__ */ new WeakSet();\nA(function() {\n  if (w() || !z() || _())\n    return;\n  const o = U();\n  if (!o.length)\n    return;\n  const n = V(), v = G(), c = 0.02, d = H(), k = L(() => {\n    P.clear();\n    for (const t of y) {\n      const e = t.bvhVelocity, s = t.outerObject3d, h = t.bvhHalfHeight, i = d ? h : t.bvhRadius;\n      d ? e.add(t.bvhOnGround || t._gravity === !1 ? T : F(s).normalize().multiplyScalar(c * -n * B[0])) : e.y += t.bvhOnGround || t._gravity === !1 ? 0 : c * -n * B[0];\n      const l = t.positionUpdate;\n      l.x && (e.x = 0), l.y && (e.y = 0), l.z && (e.z = 0), l.reset(), s.position.addScaledVector(e, c), s.updateMatrixWorld();\n      const { start: r, end: p } = R;\n      p.copy(r.copy(s.position));\n      const M = Math.max(h - i, 0);\n      p.y += M, r.y -= M;\n      const E = r.clone();\n      C.setFromCenterAndSize(s.position, I.set(i * 2, h * 2, i * 2));\n      const S = q, O = D;\n      let b = 0, u, f = !1, m;\n      for (const x of o)\n        m = Y.get(x), x.shapecast({\n          intersectsBounds: (g) => g.intersectsBox(C),\n          intersectsTriangle: (g) => {\n            b = g.closestPointToSegment(R, S, O), b < i && (f = !0, u = O.sub(S).normalize().multiplyScalar(i - b), r.add(u), p.add(u));\n          }\n        });\n      f && m && N(P, t, Z).add(m);\n      const a = r.sub(E);\n      d ? t.bvhOnGround = f : (t.bvhOnGround = a.y > Math.abs(c * e.y * 0.25), v && t.bvhOnGround && Math.abs(a.y / (a.x + a.z + Number.EPSILON)) < v && (t.bvhOnGround = !1));\n      const W = Math.max(0, a.length() - 1e-5);\n      a.normalize().multiplyScalar(W), s.position.add(a), t.bvhOnGround ? e.set(0, 0, 0) : (a.normalize(), e.addScaledVector(a, -a.dot(e)));\n    }\n  });\n  return () => {\n    k.cancel();\n  };\n}, [\n  U,\n  V,\n  G,\n  H,\n  w,\n  z,\n  _\n]);\nfunction nt(o) {\n  if (o.done)\n    return;\n  J.attach(this.outerObject3d), this instanceof K && (this.width = this.depth = Math.min(this.width, this.depth)), this.rotationUpdate = new j(), this.positionUpdate = new j();\n  const n = Q(this).multiplyScalar(0.5);\n  this.bvhHalfHeight = Math.max(n.y, 0.5), this.bvhRadius = Math.max(n.x, 0.5), this.bvhVelocity = new X(), y.add(this), o.then(() => {\n    y.delete(this), this.rotationUpdate = void 0, this.positionUpdate = void 0;\n  });\n}\nexport {\n  nt as default\n};\n","import { aM as p, aN as t, aO as o } from \"./index.e61493f3.mjs\";\nconst [a, s] = p([]), e = t(a, s), l = o(a, s);\nexport {\n  l as a,\n  s as g,\n  e as p\n};\n"],"names":["h","Object","defineProperty","a","s","t","e","enumerable","configurable","writable","value","i","x","constructor","this","updateX","updateY","updateZ","updateXYZ","y","z","updateXZ","reset","o","n","p","WeakMap","Set","Z","WeakSet","nt","done","outerObject3d","width","depth","Math","min","rotationUpdate","positionUpdate","multiplyScalar","bvhHalfHeight","max","bvhRadius","bvhVelocity","add","then","delete","length","v","c","d","k","bvhOnGround","_gravity","normalize","l","position","addScaledVector","updateMatrixWorld","start","r","end","copy","M","E","clone","S","O","u","m","b","f","shapecast","intersectsBounds","g","intersectsBox","intersectsTriangle","closestPointToSegment","sub","abs","Number","EPSILON","W","set","dot","cancel"],"sourceRoot":""}